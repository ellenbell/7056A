<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 9 Multivariate Linear Modelling | Statistics for Biologists</title>
  <meta name="description" content="This is the coursebook for BIO-7056A Statistics for Biologists" />
  <meta name="generator" content="bookdown 0.27 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 9 Multivariate Linear Modelling | Statistics for Biologists" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="This is the coursebook for BIO-7056A Statistics for Biologists" />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 9 Multivariate Linear Modelling | Statistics for Biologists" />
  
  <meta name="twitter:description" content="This is the coursebook for BIO-7056A Statistics for Biologists" />
  

<meta name="author" content="Dr Ellen Bell" />


<meta name="date" content="2024-09-19" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="coursework-1-the-kooki-bird-summative-assignment.html"/>
<link rel="next" href="workshop-9---model-structure.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Statistics for Biologists</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Welcome to the Statistics Coursebook</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#introduction"><i class="fa fa-check"></i><b>1.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="index.html"><a href="index.html#learning-objectives"><i class="fa fa-check"></i><b>1.1.1</b> Learning Objectives</a></li>
<li class="chapter" data-level="1.1.2" data-path="index.html"><a href="index.html#teaching-layout"><i class="fa fa-check"></i><b>1.1.2</b> Teaching Layout</a></li>
<li class="chapter" data-level="1.1.3" data-path="index.html"><a href="index.html#how-to-use-this-workbook"><i class="fa fa-check"></i><b>1.1.3</b> How to use this workbook</a></li>
<li class="chapter" data-level="1.1.4" data-path="index.html"><a href="index.html#why-are-we-learning-r"><i class="fa fa-check"></i><b>1.1.4</b> Why are we learning R</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#intro-to-posit"><i class="fa fa-check"></i><b>1.2</b> Practical 1 - Introduction to posit Cloud</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="index.html"><a href="index.html#task-1-create-your-own-posit-cloud-account"><i class="fa fa-check"></i><b>1.2.1</b> Task 1; Create your own posit Cloud account</a></li>
<li class="chapter" data-level="1.2.2" data-path="index.html"><a href="index.html#creating-your-first-posit-cloud-project"><i class="fa fa-check"></i><b>1.2.2</b> Creating your first posit Cloud Project</a></li>
<li class="chapter" data-level="1.2.3" data-path="index.html"><a href="index.html#a-warning-on-managing-your-work-flow"><i class="fa fa-check"></i><b>1.2.3</b> A warning on managing your work flow</a></li>
<li class="chapter" data-level="1.2.4" data-path="index.html"><a href="index.html#c2"><i class="fa fa-check"></i><b>1.2.4</b> Task 2; Some fundamentals to effective use of R</a></li>
<li class="chapter" data-level="1.2.5" data-path="index.html"><a href="index.html#using-an-r-script"><i class="fa fa-check"></i><b>1.2.5</b> Task 3; Using an R script</a></li>
<li class="chapter" data-level="1.2.6" data-path="index.html"><a href="index.html#task-4-creating-objects"><i class="fa fa-check"></i><b>1.2.6</b> Task 4; Creating objects</a></li>
<li class="chapter" data-level="1.2.7" data-path="index.html"><a href="index.html#task-5-using-functions"><i class="fa fa-check"></i><b>1.2.7</b> Task 5; Using functions</a></li>
<li class="chapter" data-level="1.2.8" data-path="index.html"><a href="index.html#installing-packages"><i class="fa fa-check"></i><b>1.2.8</b> Task 6; Playing with packages</a></li>
<li class="chapter" data-level="1.2.9" data-path="index.html"><a href="index.html#analysis-hygiene"><i class="fa fa-check"></i><b>1.2.9</b> Analysis hygiene</a></li>
<li class="chapter" data-level="1.2.10" data-path="index.html"><a href="index.html#what-do-i-do-if-i-get-an-error-message"><i class="fa fa-check"></i><b>1.2.10</b> What do I do if I get an error message?</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#conclusion"><i class="fa fa-check"></i><b>1.3</b> Conclusion</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#before-you-leave"><i class="fa fa-check"></i><b>1.4</b> Before you leave!</a></li>
<li class="chapter" data-level="1.5" data-path="index.html"><a href="index.html#references"><i class="fa fa-check"></i><b>1.5</b> References</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="workshop-2---explorartory-data-analysis.html"><a href="workshop-2---explorartory-data-analysis.html"><i class="fa fa-check"></i><b>2</b> Workshop 2 - Explorartory Data Analysis</a>
<ul>
<li class="chapter" data-level="2.1" data-path="workshop-2---explorartory-data-analysis.html"><a href="workshop-2---explorartory-data-analysis.html#introduction-1"><i class="fa fa-check"></i><b>2.1</b> Introduction</a></li>
<li class="chapter" data-level="2.2" data-path="workshop-2---explorartory-data-analysis.html"><a href="workshop-2---explorartory-data-analysis.html#practical-2---exploring-distributions-in-r"><i class="fa fa-check"></i><b>2.2</b> Practical 2 - Exploring distributions in R</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="workshop-2---explorartory-data-analysis.html"><a href="workshop-2---explorartory-data-analysis.html#task-1-setting-up-our-workspace-and-script"><i class="fa fa-check"></i><b>2.2.1</b> Task 1: Setting up our workspace and script</a></li>
<li class="chapter" data-level="2.2.2" data-path="workshop-2---explorartory-data-analysis.html"><a href="workshop-2---explorartory-data-analysis.html#task-2-importing-the-data"><i class="fa fa-check"></i><b>2.2.2</b> Task 2: Importing the data</a></li>
<li class="chapter" data-level="2.2.3" data-path="workshop-2---explorartory-data-analysis.html"><a href="workshop-2---explorartory-data-analysis.html#checking-the-data"><i class="fa fa-check"></i><b>2.2.3</b> Task 3: Checking the data</a></li>
<li class="chapter" data-level="2.2.4" data-path="workshop-2---explorartory-data-analysis.html"><a href="workshop-2---explorartory-data-analysis.html#histogram"><i class="fa fa-check"></i><b>2.2.4</b> Task 4: When in doubt - make a histogram</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="workshop-2---explorartory-data-analysis.html"><a href="workshop-2---explorartory-data-analysis.html#descriptive-statistics-in-r"><i class="fa fa-check"></i><b>2.3</b> Descriptive statistics in R</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="workshop-2---explorartory-data-analysis.html"><a href="workshop-2---explorartory-data-analysis.html#descriptive-statistics"><i class="fa fa-check"></i><b>2.3.1</b> Task 5: Descriptive statistics</a></li>
<li class="chapter" data-level="2.3.2" data-path="workshop-2---explorartory-data-analysis.html"><a href="workshop-2---explorartory-data-analysis.html#task-6-finding-the-range-and-the-mode"><i class="fa fa-check"></i><b>2.3.2</b> Task 6: Finding the range and the mode</a></li>
<li class="chapter" data-level="2.3.3" data-path="workshop-2---explorartory-data-analysis.html"><a href="workshop-2---explorartory-data-analysis.html#task-7-interpretation"><i class="fa fa-check"></i><b>2.3.3</b> Task 7: Interpretation</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="workshop-2---explorartory-data-analysis.html"><a href="workshop-2---explorartory-data-analysis.html#conclusion-1"><i class="fa fa-check"></i><b>2.4</b> Conclusion</a></li>
<li class="chapter" data-level="2.5" data-path="workshop-2---explorartory-data-analysis.html"><a href="workshop-2---explorartory-data-analysis.html#before-you-leave-1"><i class="fa fa-check"></i><b>2.5</b> Before you leave!</a></li>
<li class="chapter" data-level="2.6" data-path="workshop-2---explorartory-data-analysis.html"><a href="workshop-2---explorartory-data-analysis.html#references-1"><i class="fa fa-check"></i><b>2.6</b> References</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="workshop-3---sampling-distributions-and-testing-for-differences.html"><a href="workshop-3---sampling-distributions-and-testing-for-differences.html"><i class="fa fa-check"></i><b>3</b> Workshop 3 - Sampling Distributions and Testing for Differences</a>
<ul>
<li class="chapter" data-level="3.1" data-path="workshop-3---sampling-distributions-and-testing-for-differences.html"><a href="workshop-3---sampling-distributions-and-testing-for-differences.html#introduction-2"><i class="fa fa-check"></i><b>3.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="" data-path="workshop-3---sampling-distributions-and-testing-for-differences.html"><a href="workshop-3---sampling-distributions-and-testing-for-differences.html#sampling"><i class="fa fa-check"></i>Sampling</a></li>
<li class="chapter" data-level="" data-path="workshop-3---sampling-distributions-and-testing-for-differences.html"><a href="workshop-3---sampling-distributions-and-testing-for-differences.html#sampling-error"><i class="fa fa-check"></i>Sampling error</a></li>
<li class="chapter" data-level="" data-path="workshop-3---sampling-distributions-and-testing-for-differences.html"><a href="workshop-3---sampling-distributions-and-testing-for-differences.html#probability"><i class="fa fa-check"></i>Probability</a></li>
<li class="chapter" data-level="" data-path="workshop-3---sampling-distributions-and-testing-for-differences.html"><a href="workshop-3---sampling-distributions-and-testing-for-differences.html#variance"><i class="fa fa-check"></i>Variance</a></li>
<li class="chapter" data-level="" data-path="workshop-3---sampling-distributions-and-testing-for-differences.html"><a href="workshop-3---sampling-distributions-and-testing-for-differences.html#standard-deviation"><i class="fa fa-check"></i>Standard Deviation</a></li>
<li class="chapter" data-level="" data-path="workshop-3---sampling-distributions-and-testing-for-differences.html"><a href="workshop-3---sampling-distributions-and-testing-for-differences.html#standard-error-of-the-mean"><i class="fa fa-check"></i>Standard Error of the Mean</a></li>
<li class="chapter" data-level="" data-path="workshop-3---sampling-distributions-and-testing-for-differences.html"><a href="workshop-3---sampling-distributions-and-testing-for-differences.html#confidence-intervals"><i class="fa fa-check"></i>Confidence Intervals</a></li>
<li class="chapter" data-level="" data-path="workshop-3---sampling-distributions-and-testing-for-differences.html"><a href="workshop-3---sampling-distributions-and-testing-for-differences.html#t-tests"><i class="fa fa-check"></i>T-tests</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="workshop-3---sampling-distributions-and-testing-for-differences.html"><a href="workshop-3---sampling-distributions-and-testing-for-differences.html#some-key-terms-for-todays-practical"><i class="fa fa-check"></i><b>3.2</b> Some key terms for todays practical</a></li>
<li class="chapter" data-level="3.3" data-path="workshop-3---sampling-distributions-and-testing-for-differences.html"><a href="workshop-3---sampling-distributions-and-testing-for-differences.html#practical-3---sampling-and-testing-for-differences"><i class="fa fa-check"></i><b>3.3</b> Practical 3 - Sampling and Testing for Differences</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="workshop-3---sampling-distributions-and-testing-for-differences.html"><a href="workshop-3---sampling-distributions-and-testing-for-differences.html#the-data"><i class="fa fa-check"></i><b>3.3.1</b> The Data</a></li>
<li class="chapter" data-level="3.3.2" data-path="workshop-3---sampling-distributions-and-testing-for-differences.html"><a href="workshop-3---sampling-distributions-and-testing-for-differences.html#task-1---setting-up-your-workspace"><i class="fa fa-check"></i><b>3.3.2</b> Task 1 - Setting up your workspace</a></li>
<li class="chapter" data-level="3.3.3" data-path="workshop-3---sampling-distributions-and-testing-for-differences.html"><a href="workshop-3---sampling-distributions-and-testing-for-differences.html#task-2---checking-the-data"><i class="fa fa-check"></i><b>3.3.3</b> Task 2 - Checking the data</a></li>
<li class="chapter" data-level="3.3.4" data-path="workshop-3---sampling-distributions-and-testing-for-differences.html"><a href="workshop-3---sampling-distributions-and-testing-for-differences.html#task-3---making-some-basic-plots"><i class="fa fa-check"></i><b>3.3.4</b> Task 3 - Making some basic plots</a></li>
<li class="chapter" data-level="3.3.5" data-path="workshop-3---sampling-distributions-and-testing-for-differences.html"><a href="workshop-3---sampling-distributions-and-testing-for-differences.html#task-4---produce-some-descriptive-statistics"><i class="fa fa-check"></i><b>3.3.5</b> Task 4 - Produce some descriptive statistics</a></li>
<li class="chapter" data-level="3.3.6" data-path="workshop-3---sampling-distributions-and-testing-for-differences.html"><a href="workshop-3---sampling-distributions-and-testing-for-differences.html#task-5---answering-question-1"><i class="fa fa-check"></i><b>3.3.6</b> Task 5 - Answering Question 1</a></li>
<li class="chapter" data-level="3.3.7" data-path="workshop-3---sampling-distributions-and-testing-for-differences.html"><a href="workshop-3---sampling-distributions-and-testing-for-differences.html#levene-test"><i class="fa fa-check"></i><b>3.3.7</b> Task 6 - Answering Question 2</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="workshop-3---sampling-distributions-and-testing-for-differences.html"><a href="workshop-3---sampling-distributions-and-testing-for-differences.html#conclusion-2"><i class="fa fa-check"></i><b>3.4</b> Conclusion</a></li>
<li class="chapter" data-level="3.5" data-path="workshop-3---sampling-distributions-and-testing-for-differences.html"><a href="workshop-3---sampling-distributions-and-testing-for-differences.html#before-you-leave-2"><i class="fa fa-check"></i><b>3.5</b> Before you leave!</a></li>
<li class="chapter" data-level="3.6" data-path="workshop-3---sampling-distributions-and-testing-for-differences.html"><a href="workshop-3---sampling-distributions-and-testing-for-differences.html#references-2"><i class="fa fa-check"></i><b>3.6</b> References</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="differences.html"><a href="differences.html"><i class="fa fa-check"></i><b>4</b> Workshop 4 - Introduction to Design and Analysis of Experiments</a>
<ul>
<li class="chapter" data-level="4.1" data-path="differences.html"><a href="differences.html#introduction-3"><i class="fa fa-check"></i><b>4.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="" data-path="differences.html"><a href="differences.html#experimental-design"><i class="fa fa-check"></i>Experimental Design</a></li>
<li class="chapter" data-level="" data-path="differences.html"><a href="differences.html#analysis-of-variance"><i class="fa fa-check"></i>Analysis of Variance</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="differences.html"><a href="differences.html#practical-4---introduction-to-analysis-of-variance"><i class="fa fa-check"></i><b>4.2</b> Practical 4 - Introduction to Analysis of Variance</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="differences.html"><a href="differences.html#aims"><i class="fa fa-check"></i><b>4.2.1</b> Aims</a></li>
<li class="chapter" data-level="4.2.2" data-path="differences.html"><a href="differences.html#the-data-1"><i class="fa fa-check"></i><b>4.2.2</b> The Data</a></li>
<li class="chapter" data-level="4.2.3" data-path="differences.html"><a href="differences.html#task-1---setting-up-your-workspace-1"><i class="fa fa-check"></i><b>4.2.3</b> Task 1 - Setting up your workspace</a></li>
<li class="chapter" data-level="4.2.4" data-path="differences.html"><a href="differences.html#c5t2"><i class="fa fa-check"></i><b>4.2.4</b> Task 2 - Checking the data</a></li>
<li class="chapter" data-level="4.2.5" data-path="differences.html"><a href="differences.html#c5t3"><i class="fa fa-check"></i><b>4.2.5</b> Task 3 - Making some basic plots</a></li>
<li class="chapter" data-level="4.2.6" data-path="differences.html"><a href="differences.html#c5t4"><i class="fa fa-check"></i><b>4.2.6</b> Task 4 - Produce some descriptive statistics</a></li>
<li class="chapter" data-level="4.2.7" data-path="differences.html"><a href="differences.html#task-5---experiment-1---one-way-anova"><i class="fa fa-check"></i><b>4.2.7</b> Task 5 - Experiment 1 - One-way ANOVA</a></li>
<li class="chapter" data-level="4.2.8" data-path="differences.html"><a href="differences.html#first-boxplot"><i class="fa fa-check"></i><b>4.2.8</b> Task 6 - Experiment 2 - Two-way ANOVA</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="differences.html"><a href="differences.html#conclusion-3"><i class="fa fa-check"></i><b>4.3</b> Conclusion</a></li>
<li class="chapter" data-level="4.4" data-path="differences.html"><a href="differences.html#before-you-leave-3"><i class="fa fa-check"></i><b>4.4</b> Before you leave!</a></li>
<li class="chapter" data-level="4.5" data-path="differences.html"><a href="differences.html#references-3"><i class="fa fa-check"></i><b>4.5</b> References</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="workshop-5---testing-for-and-measuring-relationships.html"><a href="workshop-5---testing-for-and-measuring-relationships.html"><i class="fa fa-check"></i><b>5</b> Workshop 5 - Testing for and Measuring Relationships</a>
<ul>
<li class="chapter" data-level="5.1" data-path="workshop-5---testing-for-and-measuring-relationships.html"><a href="workshop-5---testing-for-and-measuring-relationships.html#introduction-4"><i class="fa fa-check"></i><b>5.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="" data-path="workshop-5---testing-for-and-measuring-relationships.html"><a href="workshop-5---testing-for-and-measuring-relationships.html#direction-of-associations"><i class="fa fa-check"></i>Direction of associations</a></li>
<li class="chapter" data-level="" data-path="workshop-5---testing-for-and-measuring-relationships.html"><a href="workshop-5---testing-for-and-measuring-relationships.html#fitting-the-regression"><i class="fa fa-check"></i>Fitting the regression</a></li>
<li class="chapter" data-level="" data-path="workshop-5---testing-for-and-measuring-relationships.html"><a href="workshop-5---testing-for-and-measuring-relationships.html#assumptions"><i class="fa fa-check"></i>Assumptions</a></li>
<li class="chapter" data-level="" data-path="workshop-5---testing-for-and-measuring-relationships.html"><a href="workshop-5---testing-for-and-measuring-relationships.html#correlation"><i class="fa fa-check"></i>Correlation</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="workshop-5---testing-for-and-measuring-relationships.html"><a href="workshop-5---testing-for-and-measuring-relationships.html#practical-5---regression-correlation-introduction"><i class="fa fa-check"></i><b>5.2</b> Practical 5 - Regression &amp; Correlation Introduction</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="workshop-5---testing-for-and-measuring-relationships.html"><a href="workshop-5---testing-for-and-measuring-relationships.html#the-data-2"><i class="fa fa-check"></i><b>5.2.1</b> The Data</a></li>
<li class="chapter" data-level="5.2.2" data-path="workshop-5---testing-for-and-measuring-relationships.html"><a href="workshop-5---testing-for-and-measuring-relationships.html#manual-data-entry"><i class="fa fa-check"></i><b>5.2.2</b> Task 1 - Setting up your workspace</a></li>
<li class="chapter" data-level="5.2.3" data-path="workshop-5---testing-for-and-measuring-relationships.html"><a href="workshop-5---testing-for-and-measuring-relationships.html#c6t2"><i class="fa fa-check"></i><b>5.2.3</b> Task 2 - Making some basic plots</a></li>
<li class="chapter" data-level="5.2.4" data-path="workshop-5---testing-for-and-measuring-relationships.html"><a href="workshop-5---testing-for-and-measuring-relationships.html#c6t3"><i class="fa fa-check"></i><b>5.2.4</b> Task 3 - Regression analysis</a></li>
<li class="chapter" data-level="" data-path="workshop-5---testing-for-and-measuring-relationships.html"><a href="workshop-5---testing-for-and-measuring-relationships.html#task-4---correlation-analysis"><i class="fa fa-check"></i>Task 4 - correlation analysis</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="workshop-5---testing-for-and-measuring-relationships.html"><a href="workshop-5---testing-for-and-measuring-relationships.html#conclusion-4"><i class="fa fa-check"></i><b>5.3</b> Conclusion</a></li>
<li class="chapter" data-level="5.4" data-path="workshop-5---testing-for-and-measuring-relationships.html"><a href="workshop-5---testing-for-and-measuring-relationships.html#before-you-leave-4"><i class="fa fa-check"></i><b>5.4</b> Before you leave!</a></li>
<li class="chapter" data-level="5.5" data-path="workshop-5---testing-for-and-measuring-relationships.html"><a href="workshop-5---testing-for-and-measuring-relationships.html#references-4"><i class="fa fa-check"></i><b>5.5</b> References</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="workshop-6---issues-with-probability-and-parametric-analysis.html"><a href="workshop-6---issues-with-probability-and-parametric-analysis.html"><i class="fa fa-check"></i><b>6</b> Workshop 6 - Issues with Probability and Parametric Analysis</a>
<ul>
<li class="chapter" data-level="6.1" data-path="workshop-6---issues-with-probability-and-parametric-analysis.html"><a href="workshop-6---issues-with-probability-and-parametric-analysis.html#introduction-5"><i class="fa fa-check"></i><b>6.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="" data-path="workshop-6---issues-with-probability-and-parametric-analysis.html"><a href="workshop-6---issues-with-probability-and-parametric-analysis.html#non-normal-data-homogeneity-of-variance"><i class="fa fa-check"></i>Non-normal data &amp; homogeneity of variance</a></li>
<li class="chapter" data-level="" data-path="workshop-6---issues-with-probability-and-parametric-analysis.html"><a href="workshop-6---issues-with-probability-and-parametric-analysis.html#transformations"><i class="fa fa-check"></i>Transformations</a></li>
<li class="chapter" data-level="" data-path="workshop-6---issues-with-probability-and-parametric-analysis.html"><a href="workshop-6---issues-with-probability-and-parametric-analysis.html#non-parametric-methods"><i class="fa fa-check"></i>Non-parametric methods</a></li>
<li class="chapter" data-level="" data-path="workshop-6---issues-with-probability-and-parametric-analysis.html"><a href="workshop-6---issues-with-probability-and-parametric-analysis.html#non-parametric-tests-for-differences"><i class="fa fa-check"></i>Non-parametric tests for differences</a></li>
<li class="chapter" data-level="" data-path="workshop-6---issues-with-probability-and-parametric-analysis.html"><a href="workshop-6---issues-with-probability-and-parametric-analysis.html#non-parametric-tests-for-association"><i class="fa fa-check"></i>Non-parametric tests for association</a></li>
<li class="chapter" data-level="" data-path="workshop-6---issues-with-probability-and-parametric-analysis.html"><a href="workshop-6---issues-with-probability-and-parametric-analysis.html#pitfalls-of-non-parametric-tests"><i class="fa fa-check"></i>Pitfalls of non-parametric tests</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="workshop-6---issues-with-probability-and-parametric-analysis.html"><a href="workshop-6---issues-with-probability-and-parametric-analysis.html#practical-6---transformations-non-parametric-tests---an-introduction"><i class="fa fa-check"></i><b>6.2</b> Practical 6 - Transformations &amp; Non-parametric Tests - An Introduction</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="workshop-6---issues-with-probability-and-parametric-analysis.html"><a href="workshop-6---issues-with-probability-and-parametric-analysis.html#task-1---setting-up-your-workspace-2"><i class="fa fa-check"></i><b>6.2.1</b> Task 1 - Setting up your workspace</a></li>
<li class="chapter" data-level="6.2.2" data-path="workshop-6---issues-with-probability-and-parametric-analysis.html"><a href="workshop-6---issues-with-probability-and-parametric-analysis.html#c7t2"><i class="fa fa-check"></i><b>6.2.2</b> Task 2 - Explore the data</a></li>
<li class="chapter" data-level="6.2.3" data-path="workshop-6---issues-with-probability-and-parametric-analysis.html"><a href="workshop-6---issues-with-probability-and-parametric-analysis.html#c7t3"><i class="fa fa-check"></i><b>6.2.3</b> Task 3 - Data transformations</a></li>
<li class="chapter" data-level="6.2.4" data-path="workshop-6---issues-with-probability-and-parametric-analysis.html"><a href="workshop-6---issues-with-probability-and-parametric-analysis.html#task-4---non-parametric-analysis-of-the-differences"><i class="fa fa-check"></i><b>6.2.4</b> Task 4 - Non-parametric analysis of the differences</a></li>
<li class="chapter" data-level="6.2.5" data-path="workshop-6---issues-with-probability-and-parametric-analysis.html"><a href="workshop-6---issues-with-probability-and-parametric-analysis.html#task-5---non-parametric-test-for-associations"><i class="fa fa-check"></i><b>6.2.5</b> Task 5 - Non-parametric test for associations</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="workshop-6---issues-with-probability-and-parametric-analysis.html"><a href="workshop-6---issues-with-probability-and-parametric-analysis.html#conclusion-5"><i class="fa fa-check"></i><b>6.3</b> Conclusion</a></li>
<li class="chapter" data-level="6.4" data-path="workshop-6---issues-with-probability-and-parametric-analysis.html"><a href="workshop-6---issues-with-probability-and-parametric-analysis.html#before-you-leave-5"><i class="fa fa-check"></i><b>6.4</b> Before you leave!</a></li>
<li class="chapter" data-level="6.5" data-path="workshop-6---issues-with-probability-and-parametric-analysis.html"><a href="workshop-6---issues-with-probability-and-parametric-analysis.html#references-5"><i class="fa fa-check"></i><b>6.5</b> References</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="workshop-7---plot-beautification.html"><a href="workshop-7---plot-beautification.html"><i class="fa fa-check"></i><b>7</b> Workshop 7 - Plot Beautification!!!</a>
<ul>
<li class="chapter" data-level="7.1" data-path="workshop-7---plot-beautification.html"><a href="workshop-7---plot-beautification.html#deconstructing-ggplot"><i class="fa fa-check"></i><b>7.1</b> Deconstructing ggplot</a></li>
<li class="chapter" data-level="7.2" data-path="workshop-7---plot-beautification.html"><a href="workshop-7---plot-beautification.html#labels"><i class="fa fa-check"></i><b>7.2</b> Labels</a></li>
<li class="chapter" data-level="7.3" data-path="workshop-7---plot-beautification.html"><a href="workshop-7---plot-beautification.html#colours"><i class="fa fa-check"></i><b>7.3</b> Switching up colours</a></li>
<li class="chapter" data-level="7.4" data-path="workshop-7---plot-beautification.html"><a href="workshop-7---plot-beautification.html#spacing"><i class="fa fa-check"></i><b>7.4</b> Spacing</a></li>
<li class="chapter" data-level="7.5" data-path="workshop-7---plot-beautification.html"><a href="workshop-7---plot-beautification.html#themes"><i class="fa fa-check"></i><b>7.5</b> Themes</a></li>
<li class="chapter" data-level="7.6" data-path="workshop-7---plot-beautification.html"><a href="workshop-7---plot-beautification.html#beautifying-scatter-plots"><i class="fa fa-check"></i><b>7.6</b> Beautifying scatter plots</a></li>
<li class="chapter" data-level="7.7" data-path="workshop-7---plot-beautification.html"><a href="workshop-7---plot-beautification.html#exporting-your-plot-to-pdf"><i class="fa fa-check"></i><b>7.7</b> Exporting your plot to pdf</a></li>
<li class="chapter" data-level="7.8" data-path="workshop-7---plot-beautification.html"><a href="workshop-7---plot-beautification.html#before-you-leave-6"><i class="fa fa-check"></i><b>7.8</b> Before you leave!</a></li>
<li class="chapter" data-level="7.9" data-path="workshop-7---plot-beautification.html"><a href="workshop-7---plot-beautification.html#references-6"><i class="fa fa-check"></i><b>7.9</b> References</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="coursework-1-the-kooki-bird-summative-assignment.html"><a href="coursework-1-the-kooki-bird-summative-assignment.html"><i class="fa fa-check"></i><b>8</b> Coursework 1; The Kooki Bird Summative Assignment</a>
<ul>
<li class="chapter" data-level="8.1" data-path="coursework-1-the-kooki-bird-summative-assignment.html"><a href="coursework-1-the-kooki-bird-summative-assignment.html#the-exercise"><i class="fa fa-check"></i><b>8.1</b> The exercise</a></li>
<li class="chapter" data-level="8.2" data-path="coursework-1-the-kooki-bird-summative-assignment.html"><a href="coursework-1-the-kooki-bird-summative-assignment.html#the-problem"><i class="fa fa-check"></i><b>8.2</b> The Problem</a></li>
<li class="chapter" data-level="8.3" data-path="coursework-1-the-kooki-bird-summative-assignment.html"><a href="coursework-1-the-kooki-bird-summative-assignment.html#the-data-3"><i class="fa fa-check"></i><b>8.3</b> The Data</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="multivariate-linear-modelling.html"><a href="multivariate-linear-modelling.html"><i class="fa fa-check"></i><b>9</b> Multivariate Linear Modelling</a>
<ul>
<li class="chapter" data-level="9.1" data-path="multivariate-linear-modelling.html"><a href="multivariate-linear-modelling.html#introduction-6"><i class="fa fa-check"></i><b>9.1</b> Introduction</a></li>
<li class="chapter" data-level="9.2" data-path="multivariate-linear-modelling.html"><a href="multivariate-linear-modelling.html#practical-8---multiple-linear-models"><i class="fa fa-check"></i><b>9.2</b> Practical 8 - Multiple Linear Models</a></li>
<li class="chapter" data-level="9.3" data-path="multivariate-linear-modelling.html"><a href="multivariate-linear-modelling.html#data-set-1-africa"><i class="fa fa-check"></i><b>9.3</b> Data set 1: Africa</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="multivariate-linear-modelling.html"><a href="multivariate-linear-modelling.html#task-1---checking-the-data"><i class="fa fa-check"></i><b>9.3.1</b> Task 1 - Checking the data</a></li>
<li class="chapter" data-level="9.3.2" data-path="multivariate-linear-modelling.html"><a href="multivariate-linear-modelling.html#task-2---exploring-the-data"><i class="fa fa-check"></i><b>9.3.2</b> Task 2 - Exploring the data</a></li>
<li class="chapter" data-level="9.3.3" data-path="multivariate-linear-modelling.html"><a href="multivariate-linear-modelling.html#task-3---regression-analysis"><i class="fa fa-check"></i><b>9.3.3</b> Task 3 - Regression analysis</a></li>
<li class="chapter" data-level="9.3.4" data-path="multivariate-linear-modelling.html"><a href="multivariate-linear-modelling.html#c11t4"><i class="fa fa-check"></i><b>9.3.4</b> Task 4 - Multivariate linear regression analysis</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="multivariate-linear-modelling.html"><a href="multivariate-linear-modelling.html#data-set-2-chaffinch"><i class="fa fa-check"></i><b>9.4</b> Data set 2: Chaffinch</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="multivariate-linear-modelling.html"><a href="multivariate-linear-modelling.html#task-1---checking-the-data-1"><i class="fa fa-check"></i><b>9.4.1</b> Task 1 - Checking the data</a></li>
<li class="chapter" data-level="9.4.2" data-path="multivariate-linear-modelling.html"><a href="multivariate-linear-modelling.html#task-2---exporing-potential-relationships"><i class="fa fa-check"></i><b>9.4.2</b> Task 2 - Exporing potential relationships</a></li>
<li class="chapter" data-level="9.4.3" data-path="multivariate-linear-modelling.html"><a href="multivariate-linear-modelling.html#task-3---multiple-regression-analysis"><i class="fa fa-check"></i><b>9.4.3</b> Task 3 - Multiple regression analysis</a></li>
<li class="chapter" data-level="9.4.4" data-path="multivariate-linear-modelling.html"><a href="multivariate-linear-modelling.html#task-4---when-good-predictors-go-bad-multicollinearity"><i class="fa fa-check"></i><b>9.4.4</b> Task 4 - When good predictors go bad (multicollinearity)</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="multivariate-linear-modelling.html"><a href="multivariate-linear-modelling.html#data-set-3-beetles"><i class="fa fa-check"></i><b>9.5</b> Data set 3: Beetles</a>
<ul>
<li class="chapter" data-level="9.5.1" data-path="multivariate-linear-modelling.html"><a href="multivariate-linear-modelling.html#c11t1"><i class="fa fa-check"></i><b>9.5.1</b> Task 1 - Checking the data</a></li>
<li class="chapter" data-level="9.5.2" data-path="multivariate-linear-modelling.html"><a href="multivariate-linear-modelling.html#task-2---multiple-regression-analysis"><i class="fa fa-check"></i><b>9.5.2</b> Task 2 - Multiple regression analysis</a></li>
</ul></li>
<li class="chapter" data-level="9.6" data-path="multivariate-linear-modelling.html"><a href="multivariate-linear-modelling.html#before-you-leave-7"><i class="fa fa-check"></i><b>9.6</b> Before you leave!</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="workshop-9---model-structure.html"><a href="workshop-9---model-structure.html"><i class="fa fa-check"></i><b>10</b> Workshop 9 - Model Structure</a>
<ul>
<li class="chapter" data-level="10.1" data-path="workshop-9---model-structure.html"><a href="workshop-9---model-structure.html#introduction-7"><i class="fa fa-check"></i><b>10.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="workshop-9---model-structure.html"><a href="workshop-9---model-structure.html#fully-factorial-linear-model"><i class="fa fa-check"></i><b>10.1.1</b> Fully Factorial Linear Model</a></li>
<li class="chapter" data-level="10.1.2" data-path="workshop-9---model-structure.html"><a href="workshop-9---model-structure.html#randomised-block-linear-model"><i class="fa fa-check"></i><b>10.1.2</b> Randomised Block Linear Model</a></li>
<li class="chapter" data-level="10.1.3" data-path="workshop-9---model-structure.html"><a href="workshop-9---model-structure.html#options"><i class="fa fa-check"></i><b>10.1.3</b> Options</a></li>
<li class="chapter" data-level="10.1.4" data-path="workshop-9---model-structure.html"><a href="workshop-9---model-structure.html#post-hoc"><i class="fa fa-check"></i><b>10.1.4</b> Post-hoc</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="workshop-9---model-structure.html"><a href="workshop-9---model-structure.html#practical-9---exploring-model-structure"><i class="fa fa-check"></i><b>10.2</b> Practical 9 - Exploring Model Structure</a></li>
<li class="chapter" data-level="10.3" data-path="workshop-9---model-structure.html"><a href="workshop-9---model-structure.html#data-set-1-nepal---linear-model-with-randomised-block-designs"><i class="fa fa-check"></i><b>10.3</b> Data set 1: Nepal - Linear Model with Randomised Block designs</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="workshop-9---model-structure.html"><a href="workshop-9---model-structure.html#task-1---checking-the-data-2"><i class="fa fa-check"></i><b>10.3.1</b> Task 1 - Checking the data</a></li>
<li class="chapter" data-level="10.3.2" data-path="workshop-9---model-structure.html"><a href="workshop-9---model-structure.html#task-2---exploring-the-data-1"><i class="fa fa-check"></i><b>10.3.2</b> Task 2 - Exploring the data</a></li>
<li class="chapter" data-level="10.3.3" data-path="workshop-9---model-structure.html"><a href="workshop-9---model-structure.html#c12t3"><i class="fa fa-check"></i><b>10.3.3</b> Task 3 - Identifying experimental design</a></li>
<li class="chapter" data-level="10.3.4" data-path="workshop-9---model-structure.html"><a href="workshop-9---model-structure.html#task-4---approaches-to-our-model"><i class="fa fa-check"></i><b>10.3.4</b> Task 4 - Approaches to our model</a></li>
<li class="chapter" data-level="10.3.5" data-path="workshop-9---model-structure.html"><a href="workshop-9---model-structure.html#exploring-the-model"><i class="fa fa-check"></i><b>10.3.5</b> Exploring the model</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="workshop-9---model-structure.html"><a href="workshop-9---model-structure.html#data-set-2-tulip---linear-model-with-randomised-block-designs"><i class="fa fa-check"></i><b>10.4</b> Data set 2: Tulip - Linear Model with Randomised Block designs</a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="workshop-9---model-structure.html"><a href="workshop-9---model-structure.html#task-5---checking-the-data"><i class="fa fa-check"></i><b>10.4.1</b> Task 5 - Checking the data</a></li>
<li class="chapter" data-level="10.4.2" data-path="workshop-9---model-structure.html"><a href="workshop-9---model-structure.html#task-6---exploring-the-data"><i class="fa fa-check"></i><b>10.4.2</b> Task 6 - Exploring the data</a></li>
<li class="chapter" data-level="10.4.3" data-path="workshop-9---model-structure.html"><a href="workshop-9---model-structure.html#playing-with-some-models"><i class="fa fa-check"></i><b>10.4.3</b> Playing with some models</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="workshop-9---model-structure.html"><a href="workshop-9---model-structure.html#mixed-effects-linear-models"><i class="fa fa-check"></i><b>10.5</b> Mixed effects linear models</a></li>
<li class="chapter" data-level="10.6" data-path="workshop-9---model-structure.html"><a href="workshop-9---model-structure.html#conclusions"><i class="fa fa-check"></i><b>10.6</b> Conclusions</a></li>
<li class="chapter" data-level="10.7" data-path="workshop-9---model-structure.html"><a href="workshop-9---model-structure.html#before-you-leave-8"><i class="fa fa-check"></i><b>10.7</b> Before you leave!</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="workshop-10---repeated-measures-linear-models.html"><a href="workshop-10---repeated-measures-linear-models.html"><i class="fa fa-check"></i><b>11</b> Workshop 10 - Repeated Measures Linear Models</a>
<ul>
<li class="chapter" data-level="11.1" data-path="workshop-10---repeated-measures-linear-models.html"><a href="workshop-10---repeated-measures-linear-models.html#introduction-8"><i class="fa fa-check"></i><b>11.1</b> Introduction</a></li>
<li class="chapter" data-level="11.2" data-path="workshop-10---repeated-measures-linear-models.html"><a href="workshop-10---repeated-measures-linear-models.html#practical-10---repeated-measures-linear-models"><i class="fa fa-check"></i><b>11.2</b> Practical 10 - Repeated Measures Linear Models</a></li>
<li class="chapter" data-level="11.3" data-path="workshop-10---repeated-measures-linear-models.html"><a href="workshop-10---repeated-measures-linear-models.html#data-set-1---activity"><i class="fa fa-check"></i><b>11.3</b> Data set 1 - Activity</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="workshop-10---repeated-measures-linear-models.html"><a href="workshop-10---repeated-measures-linear-models.html#task-1---checking-the-data-3"><i class="fa fa-check"></i><b>11.3.1</b> Task 1 - Checking the data</a></li>
<li class="chapter" data-level="11.3.2" data-path="workshop-10---repeated-measures-linear-models.html"><a href="workshop-10---repeated-measures-linear-models.html#task-2---exploring-the-data-2"><i class="fa fa-check"></i><b>11.3.2</b> Task 2 - Exploring the data</a></li>
<li class="chapter" data-level="11.3.3" data-path="workshop-10---repeated-measures-linear-models.html"><a href="workshop-10---repeated-measures-linear-models.html#task-3---playing-with-some-statistics"><i class="fa fa-check"></i><b>11.3.3</b> Task 3 - Playing with some statistics</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="workshop-10---repeated-measures-linear-models.html"><a href="workshop-10---repeated-measures-linear-models.html#data-set-2---metabolism"><i class="fa fa-check"></i><b>11.4</b> Data set 2 - Metabolism</a>
<ul>
<li class="chapter" data-level="11.4.1" data-path="workshop-10---repeated-measures-linear-models.html"><a href="workshop-10---repeated-measures-linear-models.html#task-4---checking-the-data"><i class="fa fa-check"></i><b>11.4.1</b> Task 4 - Checking the data</a></li>
<li class="chapter" data-level="11.4.2" data-path="workshop-10---repeated-measures-linear-models.html"><a href="workshop-10---repeated-measures-linear-models.html#task-5---exploring-the-data"><i class="fa fa-check"></i><b>11.4.2</b> Task 5 - Exploring the data</a></li>
<li class="chapter" data-level="11.4.3" data-path="workshop-10---repeated-measures-linear-models.html"><a href="workshop-10---repeated-measures-linear-models.html#task-6---playing-with-some-statistics"><i class="fa fa-check"></i><b>11.4.3</b> Task 6 - Playing with some statistics</a></li>
</ul></li>
<li class="chapter" data-level="11.5" data-path="workshop-10---repeated-measures-linear-models.html"><a href="workshop-10---repeated-measures-linear-models.html#conclusions-1"><i class="fa fa-check"></i><b>11.5</b> Conclusions</a></li>
<li class="chapter" data-level="11.6" data-path="workshop-10---repeated-measures-linear-models.html"><a href="workshop-10---repeated-measures-linear-models.html#before-you-leave-9"><i class="fa fa-check"></i><b>11.6</b> Before you leave!</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="workshop-1112-a-very-introductory-introduction-to-generalised-linear-models.html"><a href="workshop-1112-a-very-introductory-introduction-to-generalised-linear-models.html"><i class="fa fa-check"></i><b>12</b> Workshop 11/12 A Very Introductory Introduction to Generalised Linear Models</a>
<ul>
<li class="chapter" data-level="12.1" data-path="workshop-1112-a-very-introductory-introduction-to-generalised-linear-models.html"><a href="workshop-1112-a-very-introductory-introduction-to-generalised-linear-models.html#introduction-9"><i class="fa fa-check"></i><b>12.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="12.1.1" data-path="workshop-1112-a-very-introductory-introduction-to-generalised-linear-models.html"><a href="workshop-1112-a-very-introductory-introduction-to-generalised-linear-models.html#what-is-a-generalised-linear-model-and-why-are-they-useful"><i class="fa fa-check"></i><b>12.1.1</b> What is a Generalised Linear Model and why are they useful?</a></li>
<li class="chapter" data-level="12.1.2" data-path="workshop-1112-a-very-introductory-introduction-to-generalised-linear-models.html"><a href="workshop-1112-a-very-introductory-introduction-to-generalised-linear-models.html#key-parts-of-a-glm"><i class="fa fa-check"></i><b>12.1.2</b> Key parts of a GLM</a></li>
<li class="chapter" data-level="12.1.3" data-path="workshop-1112-a-very-introductory-introduction-to-generalised-linear-models.html"><a href="workshop-1112-a-very-introductory-introduction-to-generalised-linear-models.html#different-famlies-and-their-link-functions"><i class="fa fa-check"></i><b>12.1.3</b> Different famlies and their link functions</a></li>
<li class="chapter" data-level="12.1.4" data-path="workshop-1112-a-very-introductory-introduction-to-generalised-linear-models.html"><a href="workshop-1112-a-very-introductory-introduction-to-generalised-linear-models.html#glms-with-a-poisson-error-structure"><i class="fa fa-check"></i><b>12.1.4</b> GLMs with a Poisson Error Structure</a></li>
<li class="chapter" data-level="12.1.5" data-path="workshop-1112-a-very-introductory-introduction-to-generalised-linear-models.html"><a href="workshop-1112-a-very-introductory-introduction-to-generalised-linear-models.html#glms-with-a-binomial-error-structure"><i class="fa fa-check"></i><b>12.1.5</b> GLMs with a Binomial Error Structure</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="workshop-1112-a-very-introductory-introduction-to-generalised-linear-models.html"><a href="workshop-1112-a-very-introductory-introduction-to-generalised-linear-models.html#practical-11---glms"><i class="fa fa-check"></i><b>12.2</b> Practical 11 - GLMs</a></li>
<li class="chapter" data-level="12.3" data-path="workshop-1112-a-very-introductory-introduction-to-generalised-linear-models.html"><a href="workshop-1112-a-very-introductory-introduction-to-generalised-linear-models.html#a-poisson-glm-on-some-beautifully-behaved-data"><i class="fa fa-check"></i><b>12.3</b> A Poisson GLM on some beautifully behaved data</a>
<ul>
<li class="chapter" data-level="12.3.1" data-path="workshop-1112-a-very-introductory-introduction-to-generalised-linear-models.html"><a href="workshop-1112-a-very-introductory-introduction-to-generalised-linear-models.html#task-1---check-the-data"><i class="fa fa-check"></i><b>12.3.1</b> Task 1 - Check the data</a></li>
<li class="chapter" data-level="12.3.2" data-path="workshop-1112-a-very-introductory-introduction-to-generalised-linear-models.html"><a href="workshop-1112-a-very-introductory-introduction-to-generalised-linear-models.html#task-2---exploring-the-data-3"><i class="fa fa-check"></i><b>12.3.2</b> Task 2 - Exploring the data</a></li>
<li class="chapter" data-level="12.3.3" data-path="workshop-1112-a-very-introductory-introduction-to-generalised-linear-models.html"><a href="workshop-1112-a-very-introductory-introduction-to-generalised-linear-models.html#task-3---fitting-a-glm"><i class="fa fa-check"></i><b>12.3.3</b> Task 3 - Fitting a GLM</a></li>
<li class="chapter" data-level="12.3.4" data-path="workshop-1112-a-very-introductory-introduction-to-generalised-linear-models.html"><a href="workshop-1112-a-very-introductory-introduction-to-generalised-linear-models.html#task-4---checking-the-model"><i class="fa fa-check"></i><b>12.3.4</b> Task 4 - Checking the model</a></li>
<li class="chapter" data-level="12.3.5" data-path="workshop-1112-a-very-introductory-introduction-to-generalised-linear-models.html"><a href="workshop-1112-a-very-introductory-introduction-to-generalised-linear-models.html#task-5---plotting-our-model"><i class="fa fa-check"></i><b>12.3.5</b> Task 5 - Plotting our model</a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="workshop-1112-a-very-introductory-introduction-to-generalised-linear-models.html"><a href="workshop-1112-a-very-introductory-introduction-to-generalised-linear-models.html#a-binomial-glm"><i class="fa fa-check"></i><b>12.4</b> A Binomial GLM</a>
<ul>
<li class="chapter" data-level="12.4.1" data-path="workshop-1112-a-very-introductory-introduction-to-generalised-linear-models.html"><a href="workshop-1112-a-very-introductory-introduction-to-generalised-linear-models.html#task-6---check-the-data"><i class="fa fa-check"></i><b>12.4.1</b> Task 6 - Check the data</a></li>
<li class="chapter" data-level="12.4.2" data-path="workshop-1112-a-very-introductory-introduction-to-generalised-linear-models.html"><a href="workshop-1112-a-very-introductory-introduction-to-generalised-linear-models.html#task-7---explore-the-data"><i class="fa fa-check"></i><b>12.4.2</b> Task 7 - Explore the data</a></li>
<li class="chapter" data-level="12.4.3" data-path="workshop-1112-a-very-introductory-introduction-to-generalised-linear-models.html"><a href="workshop-1112-a-very-introductory-introduction-to-generalised-linear-models.html#task-8---fitting-a-glm"><i class="fa fa-check"></i><b>12.4.3</b> Task 8 - Fitting a GLM</a></li>
<li class="chapter" data-level="12.4.4" data-path="workshop-1112-a-very-introductory-introduction-to-generalised-linear-models.html"><a href="workshop-1112-a-very-introductory-introduction-to-generalised-linear-models.html#task-9---interpretation-and-plotting"><i class="fa fa-check"></i><b>12.4.4</b> Task 9 - Interpretation and plotting</a></li>
</ul></li>
<li class="chapter" data-level="12.5" data-path="workshop-1112-a-very-introductory-introduction-to-generalised-linear-models.html"><a href="workshop-1112-a-very-introductory-introduction-to-generalised-linear-models.html#a-poisson-mixed-effects-glm"><i class="fa fa-check"></i><b>12.5</b> A Poisson Mixed Effects GLM</a>
<ul>
<li class="chapter" data-level="12.5.1" data-path="workshop-1112-a-very-introductory-introduction-to-generalised-linear-models.html"><a href="workshop-1112-a-very-introductory-introduction-to-generalised-linear-models.html#task-10---check-the-data"><i class="fa fa-check"></i><b>12.5.1</b> Task 10 - Check the data</a></li>
<li class="chapter" data-level="12.5.2" data-path="workshop-1112-a-very-introductory-introduction-to-generalised-linear-models.html"><a href="workshop-1112-a-very-introductory-introduction-to-generalised-linear-models.html#task-11---explore-the-data"><i class="fa fa-check"></i><b>12.5.2</b> Task 11 - Explore the data</a></li>
<li class="chapter" data-level="12.5.3" data-path="workshop-1112-a-very-introductory-introduction-to-generalised-linear-models.html"><a href="workshop-1112-a-very-introductory-introduction-to-generalised-linear-models.html#task-12---fitting-a-glm"><i class="fa fa-check"></i><b>12.5.3</b> Task 12 - Fitting a GLM</a></li>
</ul></li>
<li class="chapter" data-level="12.6" data-path="workshop-1112-a-very-introductory-introduction-to-generalised-linear-models.html"><a href="workshop-1112-a-very-introductory-introduction-to-generalised-linear-models.html#conclusions-2"><i class="fa fa-check"></i><b>12.6</b> Conclusions</a></li>
<li class="chapter" data-level="12.7" data-path="workshop-1112-a-very-introductory-introduction-to-generalised-linear-models.html"><a href="workshop-1112-a-very-introductory-introduction-to-generalised-linear-models.html#before-you-leave-10"><i class="fa fa-check"></i><b>12.7</b> Before you leave!</a></li>
<li class="chapter" data-level="12.8" data-path="workshop-1112-a-very-introductory-introduction-to-generalised-linear-models.html"><a href="workshop-1112-a-very-introductory-introduction-to-generalised-linear-models.html#references-7"><i class="fa fa-check"></i><b>12.8</b> References</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="coursework-2-the-black-tailed-godwit.html"><a href="coursework-2-the-black-tailed-godwit.html"><i class="fa fa-check"></i><b>13</b> Coursework 2; the black tailed godwit</a>
<ul>
<li class="chapter" data-level="13.1" data-path="coursework-2-the-black-tailed-godwit.html"><a href="coursework-2-the-black-tailed-godwit.html#patterns-of-habitat-selection-in-breeding-black-tailed-godwits-in-iceland"><i class="fa fa-check"></i><b>13.1</b> Patterns of habitat selection in breeding Black-tailed Godwits in Iceland</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Statistics for Biologists</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="multivariate-linear-modelling" class="section level1 hasAnchor" number="9">
<h1><span class="header-section-number">Chapter 9</span> Multivariate Linear Modelling<a href="multivariate-linear-modelling.html#multivariate-linear-modelling" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="introduction-6" class="section level2 hasAnchor" number="9.1">
<h2><span class="header-section-number">9.1</span> Introduction<a href="multivariate-linear-modelling.html#introduction-6" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Multivariate linear modelling techniques are used when entering more than one predictor (independent variable) into an analysis of a dependent variable (also called response variable). The process and much of the output are very similar to those of simple linear regression, in which the effect of just one predictor is assessed. The aim is to explain the variance in the dependent variable, just as in simple regression, but with multiple predictor variables. Each of the predictor variables may explain a unique part of the variance in the dependent variable, but they may also share some of the variance that they explain.</p>
<p>The form of a multiple regression equation is an extension of that in simple regression:</p>
<p><span class="math display">\[
y = m_1x_1+m_2x_2+m_3x_3...+c
\]</span></p>
<p>and the statistical analysis is also in the form of ANOVA and t-tests of each parameter.</p>
<ol style="list-style-type: decimal">
<li>Multiple regression can be greatly influenced by which predictors are included, so it is important to not just throw in any old predictor; there should be a biological hypothesis attached to each predictor that is included.</li>
<li>The default option for how predictions are entered into models is <strong>Enter</strong>: all predictors are entered simultaneously and the researcher can then choose to exclude non-significant variables (this is often called a step-down method).</li>
<li>In general with multiple regression, the fewer predictors the better, and you should have a minimum of 10-15 data points per predictor (or your model is unlikely to have sufficient power to identify relationships, should they exist)</li>
<li>Assumptions: even distribution of residuals, no heteroscedasticity and avoid collinearity of predictors (particularly when the correlation coefficient r &gt; 0.7).</li>
</ol>
<p>In a linear model, you have three ways of entering a predictor variable:</p>
<ul>
<li><strong>Covariates:</strong> continuous predictor variables are entered as covariates</li>
<li><strong>Fixed factors:</strong> these are categorical predictor variables for which you want to compare the different categories.</li>
<li><strong>Random factors:</strong> these are categorical variables that need to be included in the model but for which you don’t want to compare the categories. Random factors are often included to account for some non-independence in your data (eg multiple datapoints from the same site or year).</li>
</ul>
<p><strong>You MUST NOT include both fixed and random effects in the same linear model – for that you have to use a MIXED MODEL</strong></p>
</div>
<div id="practical-8---multiple-linear-models" class="section level2 hasAnchor" number="9.2">
<h2><span class="header-section-number">9.2</span> Practical 8 - Multiple Linear Models<a href="multivariate-linear-modelling.html#practical-8---multiple-linear-models" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>This week we will be analysing three separate data sets; Africa, chaffinch and beetle. These data are already in this weeks project space. Log into posit Cloud and return to the classroom work space, open the project called <strong>Workshop_8</strong>. Set up a new script.</p>
<p>During todays workshop, try to pay special attention to the data interpretation steps and make sure you understand the logic behind each of the decisions made.</p>
<p>Once you have joined the classroom, spend some time setting up your workspace and script as covered in Chapter <a href="index.html#workspace-setup">1.2.9.3</a> and Chapter <a href="index.html#script-setup">1.2.9.4</a>. You will need to install and load the packages <code>tidyverse</code> and <code>janitor</code> for this weeks session.</p>
</div>
<div id="data-set-1-africa" class="section level2 hasAnchor" number="9.3">
<h2><span class="header-section-number">9.3</span> Data set 1: Africa<a href="multivariate-linear-modelling.html#data-set-1-africa" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Here you will be analysing data from 34 sub-Saharan African nations, collected by the World Bank in 1985. The aim is to fit a model that can be used to predict per capita calorific intake rate and to examine, from a conservation perspective, how deforestation impacts on calorific intake.</p>
<p>The variables are:</p>
<p>Dependent Variable:</p>
<ul>
<li>daycal: per capita daily calorific intake</li>
</ul>
<p>Possible Predictor Variables:</p>
<ul>
<li>femlit: female illiteracy rate (for over 15s)</li>
<li>under15: percentage of the population under 15</li>
<li>deforest: annual rate of forest loss</li>
<li>gnp: per capita Gross National Daily Product (US $)</li>
</ul>
<p>Theories have been suggested that poor diet, as represented by low calorific intake, is more serious in countries with poor economies, lower levels of education, a young population, and high levels of deforestation. In this practical, try to assess whether such relationships exist.</p>
<div id="task-1---checking-the-data" class="section level3 hasAnchor" number="9.3.1">
<h3><span class="header-section-number">9.3.1</span> Task 1 - Checking the data<a href="multivariate-linear-modelling.html#task-1---checking-the-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Load the dataset <code>africa.csv</code> into your workspace under the object name <code>africa</code> and try performing some routine checks to make sure R has interpreted the variables correctly and all expected data is present and accounted for. You can use some of the functions explored in Chapter <a href="workshop-2---explorartory-data-analysis.html#checking-the-data">2.2.3</a> if you need some help with this.</p>
</div>
<div id="task-2---exploring-the-data" class="section level3 hasAnchor" number="9.3.2">
<h3><span class="header-section-number">9.3.2</span> Task 2 - Exploring the data<a href="multivariate-linear-modelling.html#task-2---exploring-the-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Start by exploring the univariate relationship between per capita daily calorific intake and gross national product.</p>
<blockquote>
<ul>
<li><strong>Stop to think</strong></li>
<li>Write down what question you are asking, and turn this into a word equation (i.e. y = mx + c, with symbols replaced by words).</li>
</ul>
</blockquote>
<p>Draw the scatterplot for the relationship between per capita daily calorific intake (daycal) and gross national product (gnp), revisit Chapter <a href="workshop-5---testing-for-and-measuring-relationships.html#c6t2">5.2.3</a> if you’re not sure how to do this.</p>
<blockquote>
<ul>
<li><strong>Stop to think</strong></li>
<li>Does the graph suggest that the assumptions of linear regression (i.e. that all datapoints are contributing similarly to the slope) have been met?</li>
</ul>
</blockquote>
</div>
<div id="task-3---regression-analysis" class="section level3 hasAnchor" number="9.3.3">
<h3><span class="header-section-number">9.3.3</span> Task 3 - Regression analysis<a href="multivariate-linear-modelling.html#task-3---regression-analysis" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Try running a linear regression for daily calorific intake and gross national product, store your model under the object name <code>daycal_gnp_lm_1</code> revisit Chapter <a href="workshop-5---testing-for-and-measuring-relationships.html#c6t3">5.2.4</a> if you’re not sure how to do this.</p>
<blockquote>
<ul>
<li><strong>Stop to think</strong></li>
<li>What does the regression model output tell you about the relationship between calorific intake and GNP?</li>
<li>Write down what the slope, constant, r<span class="math inline">\(^2\)</span> and p-value tell you about this relationship, and consider whether they accurately describe this relationship.</li>
</ul>
</blockquote>
<p>As we did in Chapter <a href="workshop-5---testing-for-and-measuring-relationships.html#c6t3">5.2.4</a>, try plotting the residuals against the predicted values.</p>
<blockquote>
<ul>
<li><strong>Stop to think</strong></li>
<li>From this plot, have the assumptions of the linear regression been met?</li>
</ul>
</blockquote>
<p>We can also calculate leverage values, this measures the influence of each point on the fit of the regression and can range from 0: no influence to 1: complete influence. Try running the following;</p>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="multivariate-linear-modelling.html#cb81-1" tabindex="-1"></a><span class="co"># Checking the leverage </span></span>
<span id="cb81-2"><a href="multivariate-linear-modelling.html#cb81-2" tabindex="-1"></a>africa <span class="ot">&lt;-</span> africa <span class="sc">%&gt;%</span></span>
<span id="cb81-3"><a href="multivariate-linear-modelling.html#cb81-3" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">leverage =</span> <span class="fu">hatvalues</span>(daycal_gnp_lm_1))</span></code></pre></div>
<blockquote>
<ul>
<li><strong>Stop to think</strong></li>
<li>What do the leverage values indicate?</li>
<li>Are any countries not fitting the model well?</li>
</ul>
</blockquote>
<p>Try performing a log10 transformation on the gnp variable, revisit Chapter <a href="workshop-6---issues-with-probability-and-parametric-analysis.html#c7t3">6.2.3</a> if you unsure how to do this. Then re-run the regression model using the logged variable, and redraw the scatterplot</p>
<blockquote>
<ul>
<li><strong>Stop to think</strong></li>
<li>Has the model fit improved? Compare the slope, intercept, r<span class="math inline">\(^2\)</span> and p-value to the model with the unlogged GNP.</li>
</ul>
</blockquote>
<p>Have a look at the leverage values and the residuals for your new model. Country 11 (Gabon) still has something of a disproportionate effect on the fit of the regression line (large-ish leverage), even in the model with log (GNP). Use the following command to temporarily exclude this country from our scatter plot (note we are not deleting the data completely). This will allow you to explore the influence of Gabon.</p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="multivariate-linear-modelling.html#cb82-1" tabindex="-1"></a>africa <span class="sc">%&gt;%</span></span>
<span id="cb82-2"><a href="multivariate-linear-modelling.html#cb82-2" tabindex="-1"></a>  <span class="fu">filter</span>(name <span class="sc">!=</span> <span class="st">&quot;Gabon&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb82-3"><a href="multivariate-linear-modelling.html#cb82-3" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> ., <span class="fu">aes</span>(<span class="at">x =</span> gnp, <span class="at">y =</span> daycal)) <span class="sc">+</span></span>
<span id="cb82-4"><a href="multivariate-linear-modelling.html#cb82-4" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb82-5"><a href="multivariate-linear-modelling.html#cb82-5" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> lm)</span></code></pre></div>
<p>Now use the same temporary exclusion method to re-run your regression model with Gabon temporarily excluded.</p>
<blockquote>
<ul>
<li><strong>Stop to think</strong></li>
<li>How has the regression changed? What reasons may there be for omitting Gabon from the analysis? Why should you always be careful when dropping variables for this reason?</li>
</ul>
</blockquote>
<p>Re-include Gabon into subsequent analyses.</p>
</div>
<div id="c11t4" class="section level3 hasAnchor" number="9.3.4">
<h3><span class="header-section-number">9.3.4</span> Task 4 - Multivariate linear regression analysis<a href="multivariate-linear-modelling.html#c11t4" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We are now going to build a multivariate regression model using the Enter method, in which we begin by including all predictor variables in our regression. We then remove from our regression the variable that has the least (statistically non-significant) effect to produce a better model. We repeat this until we are left with a regression containing the best sub-set of predictors. At each stage it is important to consider the impact of removing that predictor on the model.
First we will draw a matrix plot to compare all of the relationships between <code>daycal</code> and all four predictor variables (use your logged gnp variable to reduce difficulties with Gabon). Try using the following command;</p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="multivariate-linear-modelling.html#cb83-1" tabindex="-1"></a><span class="co"># Scatter matrix</span></span>
<span id="cb83-2"><a href="multivariate-linear-modelling.html#cb83-2" tabindex="-1"></a><span class="fu">pairs</span>(africa[,<span class="fu">c</span>(<span class="dv">3</span><span class="sc">:</span><span class="dv">7</span>,<span class="dv">9</span>)])</span>
<span id="cb83-3"><a href="multivariate-linear-modelling.html#cb83-3" tabindex="-1"></a><span class="co"># Note the numbers c(3:7,9) refer to column numbers for daycal, femlit, under15, deforest and log10_gnp they may be different in your data set</span></span></code></pre></div>
<blockquote>
<ul>
<li><strong>Stop to think</strong></li>
<li>Write down what these graphs tell you about each of the relationships</li>
<li>Do you see any signs of collinearity between predictor variables?</li>
</ul>
</blockquote>
<p>Now we can try fitting the full multiple regression by adding the other three predictors as independent variables with Enter as the data entry method. Try running the following;</p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="multivariate-linear-modelling.html#cb84-1" tabindex="-1"></a><span class="co"># multiple regression</span></span>
<span id="cb84-2"><a href="multivariate-linear-modelling.html#cb84-2" tabindex="-1"></a>daycal_multi_lm_1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(daycal<span class="sc">~</span>gnp<span class="sc">+</span>deforest<span class="sc">+</span>under15<span class="sc">+</span>femlit, <span class="at">data =</span> africa)</span>
<span id="cb84-3"><a href="multivariate-linear-modelling.html#cb84-3" tabindex="-1"></a><span class="fu">summary</span>(daycal_multi_lm_1)</span></code></pre></div>
<blockquote>
<ul>
<li><strong>Stop to think</strong><br />
</li>
<li>Which is the most statistically significant variable?</li>
</ul>
</blockquote>
<p>Remove the non-significant variable with the highest p-value from the regression model and examine the change in the adjusted <span class="math inline">\(r^2\)</span>.</p>
<blockquote>
<ul>
<li><strong>Stop to think</strong></li>
<li>Has removing the variable altered the explanatory power of the regression (check the adjusted r<span class="math inline">\(^2\)</span> now we are working with mulivariate linear models) very much? What has happened to the coefficients (slopes) of the remaining variables?</li>
</ul>
</blockquote>
<p>By removing the least significant variable at each stage, you reduce the regression equation until it only contains significant variables (this is called the minimum model). At each stage, check that removing a predictor variable does not cause the r<span class="math inline">\(^2\)</span> of the model to drop too much or cause the sign of the slope coefficient or the significance of other variables in the model to change strongly.</p>
<blockquote>
<ul>
<li><strong>Stop to think</strong><br />
</li>
<li>Look at your final model. How does the r<span class="math inline">\(^2\)</span> compare with the r<span class="math inline">\(^2\)</span> you obtained in exercise 1, using simple regression with log(GNP) as the sole predictor?</li>
<li>Does your final model fit in with the original hypotheses about daily calorific intake?</li>
<li>What are the agreements and disagreements between your model and the theory (look back at the suggestions listed at the start of the practical)? Looking at the coefficients may be useful here.</li>
<li>Write a word equation for your final model.</li>
<li>Use your final model to predict the expected per capita calorific intake rate for a country with a GNP of US $975, a female illiteracy rate of 45% and a deforestation rate of -2.0.</li>
</ul>
</blockquote>
<p>R has a function called <code>predict()</code> which can be used to predict values of y based on your model. Try runnign the following;</p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="multivariate-linear-modelling.html#cb85-1" tabindex="-1"></a>new <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">gnp =</span><span class="dv">975</span>, <span class="at">femlit =</span><span class="dv">45</span>, <span class="at">deforest=</span> <span class="sc">-</span><span class="dv">2</span>)</span>
<span id="cb85-2"><a href="multivariate-linear-modelling.html#cb85-2" tabindex="-1"></a><span class="co"># Create a new data frame called `new` and specify your independent variable values</span></span>
<span id="cb85-3"><a href="multivariate-linear-modelling.html#cb85-3" tabindex="-1"></a></span>
<span id="cb85-4"><a href="multivariate-linear-modelling.html#cb85-4" tabindex="-1"></a><span class="fu">predict</span>(enter_your_final_model_here, <span class="at">newdata=</span>new, <span class="at">interval =</span> <span class="st">&#39;confidence&#39;</span>)</span>
<span id="cb85-5"><a href="multivariate-linear-modelling.html#cb85-5" tabindex="-1"></a><span class="co"># Call the predict function to use your final multivariate linear model to predict the daycal value in a country with the independent variable values specified in your data frame called `new`</span></span>
<span id="cb85-6"><a href="multivariate-linear-modelling.html#cb85-6" tabindex="-1"></a><span class="co"># By including interval = &#39;confidence&#39; the output will include 95% confidence intervals.</span></span></code></pre></div>
<blockquote>
<ul>
<li><strong>Stop to think</strong></li>
<li>Compare the daycal rate you predicted for a country with a GNP of US $975, a female illiteracy rate of 45% and a deforestation rate of -2.0 to that predicted by the <code>predict()</code> function in R.</li>
<li>Does the 95% prediction interval lie above or below the minimum acceptable daily calorific intake rate of 2000 kcal? What does this mean for this hypothetical country?</li>
</ul>
</blockquote>
<p>You can also specify interactions to test using the <code>lm()</code> function by using a <code>*</code> between two variables with a potential interaction, as seen here;</p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="multivariate-linear-modelling.html#cb86-1" tabindex="-1"></a>daycal_multilog_lm_2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(daycal<span class="sc">~</span>log10_gnp<span class="sc">+</span>deforest<span class="sc">*</span>femlit, <span class="at">data =</span> africa)</span>
<span id="cb86-2"><a href="multivariate-linear-modelling.html#cb86-2" tabindex="-1"></a><span class="fu">summary</span>(daycal_multilog_lm_2)</span></code></pre></div>
<blockquote>
<ul>
<li><strong>Anaysis time</strong></li>
<li>Try customising different models, in order to explore this technique.</li>
</ul>
</blockquote>
</div>
</div>
<div id="data-set-2-chaffinch" class="section level2 hasAnchor" number="9.4">
<h2><span class="header-section-number">9.4</span> Data set 2: Chaffinch<a href="multivariate-linear-modelling.html#data-set-2-chaffinch" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Now we will move onto a second data set. Food was presented in a feeder linked to a balance for measuring mass. Individual chaffinches that had been trapped, ringed, measured and sampled for parasite prevalence were recorded visiting the feeder and the mass of food each bird consumed was recorded. The night-time temperature was also recorded and presented as an anomaly from the mean for that season. The dataset therefore contains the following variables:</p>
<ul>
<li>ring: Ring number of the bird</li>
<li>species: Chaffinch</li>
<li>age: Age class (BTO codes)</li>
<li>sex: Male or Female</li>
<li>wing: Wing length (to the nearest mm)</li>
<li>weight: Mass (to the nearest 0.1 g)</li>
<li>food: Mass of food consumed in a visit (to the nearest 0.1 g)</li>
<li>parasite: Parasite load</li>
<li>temp: Temperature anomaly (relative to the mean night time temperature for the season (0.5 degrees), closer to 1 = colder)</li>
</ul>
<div id="task-1---checking-the-data-1" class="section level3 hasAnchor" number="9.4.1">
<h3><span class="header-section-number">9.4.1</span> Task 1 - Checking the data<a href="multivariate-linear-modelling.html#task-1---checking-the-data-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Load the dataset <code>chaffinch.csv</code> into your workspace under the object name <code>chaffinch</code> and try performing some routine checks to make sure R has interpreted the variables correctly and all expected data is present and accounted for. You can use some of the functions explored in Chapter <a href="workshop-2---explorartory-data-analysis.html#checking-the-data">2.2.3</a> if you need some help with this.</p>
<blockquote>
<ul>
<li><strong>Stop to think</strong></li>
<li>If the aim of your study was to examine the factors influencing consumption rate of food by wild birds, write down which of these variables you would consider using as dependent variables and which ones as predictor variables.</li>
<li>Write down the direction you might predict for each relationship.</li>
<li>Which variables are continuous and which are categorical?</li>
</ul>
</blockquote>
</div>
<div id="task-2---exporing-potential-relationships" class="section level3 hasAnchor" number="9.4.2">
<h3><span class="header-section-number">9.4.2</span> Task 2 - Exporing potential relationships<a href="multivariate-linear-modelling.html#task-2---exporing-potential-relationships" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>As we did with the last data set, draw a matrix scatter plot of all the continuous variables</p>
<blockquote>
<ul>
<li><strong>Stop to think</strong></li>
<li>Have a look at how each variable appears to relate to your dependent variable. Are these the same directions that you predicted?</li>
<li>Do you see any problems with the data meeting the assumptions of regression?</li>
</ul>
</blockquote>
<p>The relationship between parasite load and amount of food consumed is non-linear. Given the spread of the data, a logarithmic transformation of parasite load may help to linearise this relationship. Transform the parasite variable and redraw the matrix plot.</p>
</div>
<div id="task-3---multiple-regression-analysis" class="section level3 hasAnchor" number="9.4.3">
<h3><span class="header-section-number">9.4.3</span> Task 3 - Multiple regression analysis<a href="multivariate-linear-modelling.html#task-3---multiple-regression-analysis" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>You can now build a series of models to explore specific hypotheses. Each time you should do the following:</p>
<ol style="list-style-type: decimal">
<li>Consider whether each variable is a covariate or a fixed factor</li>
<li>Make sure you check that all assumptions are met</li>
<li>Explore any collinearity between predictor variables and think about what you could do about it (see below)</li>
<li>Construct the model that contains only the significant predictor variables</li>
<li>Explore how the model changes each time you remove a predictor variable</li>
<li>Explore whether different minimum models could have been constructed</li>
<li>Draw graphs to check that you understand the model output</li>
<li>Consider what the slope, intercept, r<span class="math inline">\(^2\)</span> and p-values are telling you</li>
</ol>
</div>
<div id="task-4---when-good-predictors-go-bad-multicollinearity" class="section level3 hasAnchor" number="9.4.4">
<h3><span class="header-section-number">9.4.4</span> Task 4 - When good predictors go bad (multicollinearity)<a href="multivariate-linear-modelling.html#task-4---when-good-predictors-go-bad-multicollinearity" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>An underlying assumption of mulivariate linear model is that your predictors are not correlated with each other. That is, you are assuming that each predictor brings in entirely new information to your model. If two predictors are correlated, then they are redundant. We call this multicollinear predictors, or multicollinearity. For example, if you wanted to predict the wood volume of a tree, and you had three predictors, height, diameter, and number of rings, it is very likely that diameter and number of rings will be highly correlated with each other.</p>
<p>There are three issues with multicollinearity;</p>
<ol style="list-style-type: decimal">
<li>Firstly, if two predictors are strongly correlated with each other (strongly multicollinear) and both are in the regression model, both can end up being non-significant. That is, multicollinear predictors can cancel each other out, even if both, individually, are significant in a regression.<br />
</li>
<li>Secondly, the ‘cancelling out’ effect means that when you are simplifying a model by removing predictors, you should remove predictors one at a time instead of doing the tempting thing and removing all non-significant predictors at once. And you should try alternative minimal models.<br />
</li>
<li>Finally, the real lesson of multicollinearity is that you have redundant predictive information. Did you expect multicollinearity? Were you trying to measure the same predictor in different ways? If so, then have a good think about which predictor is more appropriate for your purpose (e.g., which one is cheaper to measure, or more scientifically appropriate, or more accurately measured, or all three). Did you not expect multicollinearity? Maybe the fact that two predictors are correlated tells you something new about your data or your system.</li>
</ol>
<p>How to detect multicollinearity? The simplest way is to run a matrix plot of your predictors, and to check correlation statistics.</p>
<p>So before you even start your regression modelling, you know that you are going to run the risk of a regression where putting two or more will lead to both being non-significant. However, this is only a risk. It is not certain. In fact, sometimes, you need both predictors in the model for either one to be significant, as we saw above. There is no way to predict which will happen, so you just have to try out different models, choosing your final model based on logic and scientific knowledge.</p>
<blockquote>
<ul>
<li><strong>Stop to think</strong></li>
<li>Take a look at your final model, do you have collinear variables included?</li>
<li>Can you justify their inclusion or do you need to adjust your model further?</li>
</ul>
</blockquote>
</div>
</div>
<div id="data-set-3-beetles" class="section level2 hasAnchor" number="9.5">
<h2><span class="header-section-number">9.5</span> Data set 3: Beetles<a href="multivariate-linear-modelling.html#data-set-3-beetles" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Finally we will consider our third data set. These data are from a study of what causes variation in the density of beetles among different patches of tall vegetation. Beetle densities were sampled on 20 sites, along with a range of other variables:</p>
<ul>
<li>beetle_density: Beetle densities in each site</li>
<li>landscape_type: Surrounding landscape (1 = arable, 2 = grassland, 3 = heath, 4 = wood)</li>
<li>patch_age: Estimated patch age in categories (from 1 = young to 3 = old)</li>
<li>patch_area: Area (m2) of each scrub patch</li>
<li>veg_height: Maximum grass height (cm) at each site</li>
<li>veg_density: Density of grass vegetation (from 1 = sparse to 5 = dense)</li>
<li>plant_species: Mean no. of plant species per m2</li>
<li>soil_moisture: Mean soil moisture level</li>
<li>soil_penetrability: Soil penetrability</li>
<li>min_temp: Mean minimum daily temperature</li>
<li>max_temp: Mean maximum daily temperature</li>
</ul>
<p>You therefore have 10 predictor variables, three of which are categorical (landscape_type, patch_age and veg_density) and the rest of which are continuous</p>
<div id="c11t1" class="section level3 hasAnchor" number="9.5.1">
<h3><span class="header-section-number">9.5.1</span> Task 1 - Checking the data<a href="multivariate-linear-modelling.html#c11t1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Load the dataset <code>beetle.csv</code> into your workspace under the object name <code>beetle</code> and try performing some routine checks to make sure R has interpreted the variables correctly and all expected data is present and accounted for. You can use some of the functions explored in Chapter <a href="workshop-2---explorartory-data-analysis.html#checking-the-data">2.2.3</a> if you need some help with this.</p>
<p>You should note that R has misidentified your categorical variables as continuous. You will need to convert these variables to factors in order to correctly build your models. Try running the following line;</p>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="multivariate-linear-modelling.html#cb87-1" tabindex="-1"></a>beetle<span class="sc">$</span>landscape_type <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(beetle<span class="sc">$</span>landscape_type)</span>
<span id="cb87-2"><a href="multivariate-linear-modelling.html#cb87-2" tabindex="-1"></a><span class="co"># Convert the variable landscape_type to a factor rather then a continuous variable</span></span></code></pre></div>
<p>Try running the <code>as.factor()</code> function on your other categorical variables (<code>patch_age</code> and <code>veg_density</code>).</p>
</div>
<div id="task-2---multiple-regression-analysis" class="section level3 hasAnchor" number="9.5.2">
<h3><span class="header-section-number">9.5.2</span> Task 2 - Multiple regression analysis<a href="multivariate-linear-modelling.html#task-2---multiple-regression-analysis" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Construct a linear model with beetle_density as your dependent variable and include all other variables as your independent variables.</p>
<blockquote>
<ul>
<li><strong>Stop to think</strong></li>
<li>Look at your model output – what has happened here?</li>
</ul>
</blockquote>
<p>The main problem is that you have only 20 datapoints, and your model is trying to use 10 different predictors to explain the variation among these 20 sites – that is <strong>too many predictors</strong>! There is no way that the model can partition the variation in beetle density among all these predictors meaningfully. Remember that you should ideally aim for 10-15 datapoints per predictor. With 20 datapoints, you can realistically construct a model with 2, or maybe 3, predictors.</p>
<p>Which should you choose? Your best bet at this point is to think about the data you have and what they are telling you. For example, take a look at your patch_age data, you may like to use the <code>group_by()</code> and <code>summarise()</code> functions to do this.</p>
<blockquote>
<ul>
<li><strong>Stop to think</strong></li>
<li>How many datapoints do you have for each of the patch_age categories?</li>
</ul>
</blockquote>
<p>With only one example of age 1 and one example of age 3, you cannot possibly understand the variation in beetle densities between these age categories – this is therefore a predictor that should be excluded, although you may wish to run the final model with and without the two sites of age 1 and 3, to see if their inclusion changes anything.</p>
<p>Categorical variables use up more degrees of freedom than continuous variables, so they can be a particular problem with small datasets.</p>
<p>Look at one of the other categorical variables, landscape_type. Draw a scatter matrix plot with landscape_type, beetle_density and all of the continuous variables.</p>
<blockquote>
<ul>
<li><strong>Stop to think</strong></li>
<li>Do any of these variables differ clearly between the four landscape types?</li>
</ul>
</blockquote>
<p>If you suspect any differences of note between any of the variables and landscape type it may be worth investigating these more closely, try checking means and standard deviations across different landscapes (you can use the <code>group_by()</code> and <code>summarise()</code> functions to do this) alternatively you may like to visualise the differences with some box plots.</p>
<blockquote>
<ul>
<li><strong>Stop to think</strong></li>
<li>What do you think now, do any of your continuous variables differ between the four landscape types?</li>
</ul>
</blockquote>
<p>Broadly, there doesn’t seem to be much difference between the continuous variables measured and the four landscapes, so it is unlikely that the surrounding landscape type is an important variable to include. Rebuild a linear model with landscape_type excluded.</p>
<blockquote>
<ul>
<li><strong>Stop to think</strong></li>
<li>How is your linear model looking now?</li>
</ul>
</blockquote>
<p>Let’s think about the other variables.</p>
<p>Draw a matrix scatterplot of all of the remaining variables.</p>
<blockquote>
<ul>
<li><strong>Stop to think</strong></li>
<li>Is there any evidence that any of the variables are strongly correlated? If so, why do you think they are correlated and do you think that including both in the model will help you to understand what influences beetle density?</li>
</ul>
</blockquote>
<p>As dry soils are typically harder, soil moisture and soil penetrability are likely to be two different ways of measuring the same thing, so you can exclude one of them. Try rebuilding your linear model with one of these variables excluded.</p>
<p>We are now left with seven predictor variables (and wishing we had collected data from more sites…). Think about each of these seven variables and how likely they are to help you understand the variation in beetle density:</p>
<blockquote>
<ul>
<li><strong>Stop to think</strong></li>
<li>Is patch area likely to influence beetle density?</li>
<li>Is the maximum height of the grass within a patch likely to influence beetle density?</li>
<li>Is the density of grass in a patch likely to influence beetle density?</li>
<li>Is soil wetness or softness likely to influence beetle density?</li>
<li>Are both temperatures likely to influence beetle density?</li>
</ul>
</blockquote>
<p>From this point onwards, you have to use your knowledge of biology and your common sense to try and pick the variables that you think will be most relevant and useful to you. For example, if the aim of your study is to develop management proposals for these sites, you might focus on variables that can be managed (i.e. vegetation and soil moisture, but not temperature). You can also explore the effect of each variable on beetle density separately, but remember that the influence of variables can change when they are included along with others in a multivariate model, so don’t use univariate exploration as the only basis for excluding variables.</p>
<blockquote>
<ul>
<li><strong>Analysis time</strong></li>
<li>Have a go at building the best model that you can for understanding the variation in beetle densities among these 20 sites.</li>
<li>Remember to draw graphs to make sure you check the model assumptions and understand the model output</li>
</ul>
</blockquote>
</div>
</div>
<div id="before-you-leave-7" class="section level2 hasAnchor" number="9.6">
<h2><span class="header-section-number">9.6</span> Before you leave!<a href="multivariate-linear-modelling.html#before-you-leave-7" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Make sure you save your script and download it if you would like to keep a local copy.</p>
<p>Please log out of posit Cloud!</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="coursework-1-the-kooki-bird-summative-assignment.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="workshop-9---model-structure.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/USERNAME/REPO/edit/BRANCH/08-Workshop8_general_linear_model.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["7056A.pdf", "7056A.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
